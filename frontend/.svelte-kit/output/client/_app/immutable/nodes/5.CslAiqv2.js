import{s as U,a as A,o as N,h as q,d,c as F,i as _,t as $,v as h,e as C,f as D,k as I,j as G,l as b,w as O}from"../chunks/scheduler.DrQRk8ea.js";import{S as K,i as L,b as g,e as M,t as k,g as W,c as E,a as w,m as S,d as j}from"../chunks/index.CcdvbsEI.js";import{f as y,a as x,p as P,i as R,g as V,N as B,h as H,j as J,k as z,l as Q}from"../chunks/Issue.bBFUSQy9.js";import{C as T}from"../chunks/Container.CWcU-xxO.js";import{g as v}from"../chunks/entry.vAbeKpqR.js";import{A as X}from"../chunks/AlertError.Bf6rdsHm.js";const Y=({params:i})=>({nostr_ref:i.nostr_ref}),de=Object.freeze(Object.defineProperty({__proto__:null,load:Y},Symbol.toStringTag,{value:"Module"}));function Z(i){let r,a;return r=new T({props:{$$slots:{default:[te]},$$scope:{ctx:i}}}),{c(){E(r.$$.fragment)},l(e){w(r.$$.fragment,e)},m(e,s){S(r,e,s),a=!0},p(e,s){const n={};s&64&&(n.$$scope={dirty:s,ctx:e}),r.$set(n)},i(e){a||(k(r.$$.fragment,e),a=!0)},o(e){g(r.$$.fragment,e),a=!1},d(e){j(r,e)}}}function ee(i){let r,a;return r=new T({props:{$$slots:{default:[ae]},$$scope:{ctx:i}}}),{c(){E(r.$$.fragment)},l(e){w(r.$$.fragment,e)},m(e,s){S(r,e,s),a=!0},p(e,s){const n={};s&69&&(n.$$scope={dirty:s,ctx:e}),r.$set(n)},i(e){a||(k(r.$$.fragment,e),a=!0)},o(e){g(r.$$.fragment,e),a=!1},d(e){j(r,e)}}}function te(i){let r;return{c(){r=$("loading...")},l(a){r=h(a,"loading...")},m(a,e){_(a,r,e)},d(a){a&&d(r)}}}function re(i){let r,a,e,s,n,c,l=i[0].nostr_ref+"",f;return{c(){r=C("div"),a=$("Error! "),e=$(i[2]),s=$(":"),n=A(),c=C("div"),f=$(l),this.h()},l(t){r=D(t,"DIV",{});var o=I(r);a=h(o,"Error! "),e=h(o,i[2]),s=h(o,":"),o.forEach(d),n=F(t),c=D(t,"DIV",{class:!0});var u=I(c);f=h(u,l),u.forEach(d),this.h()},h(){G(c,"class","break-all")},m(t,o){_(t,r,o),b(r,a),b(r,e),b(r,s),_(t,n,o),_(t,c,o),b(c,f)},p(t,o){o&4&&O(e,t[2]),o&1&&l!==(l=t[0].nostr_ref+"")&&O(f,l)},d(t){t&&(d(r),d(n),d(c))}}}function ae(i){let r,a;return r=new X({props:{$$slots:{default:[re]},$$scope:{ctx:i}}}),{c(){E(r.$$.fragment)},l(e){w(r.$$.fragment,e)},m(e,s){S(r,e,s),a=!0},p(e,s){const n={};s&69&&(n.$$scope={dirty:s,ctx:e}),r.$set(n)},i(e){a||(k(r.$$.fragment,e),a=!0)},o(e){g(r.$$.fragment,e),a=!1},d(e){j(r,e)}}}function se(i){let r,a,e,s,n;const c=[ee,Z],l=[];function f(t,o){return t[1]&&t[3]?0:1}return a=f(i),e=l[a]=c[a](i),{c(){r=A(),e.c(),s=N(),this.h()},l(t){q("svelte-bs2zwp",document.head).forEach(d),r=F(t),e.l(t),s=N(),this.h()},h(){document.title="GitWorkshop - ngit"},m(t,o){_(t,r,o),l[a].m(t,o),_(t,s,o),n=!0},p(t,[o]){let u=a;a=f(t),a===u?l[a].p(t,o):(W(),g(l[u],1,1,()=>{l[u]=null}),M(),e=l[a],e?e.p(t,o):(e=l[a]=c[a](t),e.c()),k(e,1),e.m(s.parentNode,s))},i(t){n||(k(e),n=!0)},o(t){g(e),n=!1},d(t){t&&(d(r),d(s)),l[a].d(t)}}}function oe(i,r,a){let{data:e}=r,s=!1,n="reference in URL is not a repository, proposal, issue or npub reference",c=!1;const l=t=>{t&&a(2,n=t),a(1,s=!0),a(3,c=!0)};let f=(t,o=void 0)=>{let u=V.subscribe({ids:[t],limit:100},{closeOnEose:!1},B.fromRelayUrls([...H,...o||[]],V));u.on("event",p=>{try{if(p.id==t){let m=p.tagValue("a");m?p.kind===R?(J(m,p),v(`/r/${z(m)}/issues/${y.noteEncode(t)}`)):p.kind===P?(Q(m,p),v(`/r/${z(m)}/proposals/${y.noteEncode(t)}`)):l():l('found event but it contains an invalid "a" tag reference')}}catch{}}),u.on("eose",()=>{l("cannot find event")})};return i.$$set=t=>{"data"in t&&a(0,e=t.data)},i.$$.update=()=>{if(i.$$.dirty&1)try{let t=y.decode(e.nostr_ref);t.type==="npub"||t.type==="nprofile"?v(`/p/${e.nostr_ref}`):t.type==="naddr"&&t.data.kind===x?v(`/r/${e.nostr_ref}`):t.type==="nrelay"||t.type==="nsec"?l():typeof t.data=="string"?f(t.data):(t.type==="nevent"||t.type==="note")&&!(t.data.kind&&[P,R].includes(t.data.kind))?f(t.data.id,t.data.relays):l()}catch{try{y.noteEncode(e.nostr_ref),f(e.nostr_ref)}catch{l()}}},[e,s,n,c]}class pe extends K{constructor(r){super(),L(this,r,oe,se,U,{data:0})}}export{pe as component,de as universal};
